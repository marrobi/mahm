<!-- Patient Dashboard UI for My BP - NHS App -->

<!-- ADDING CUSTOM CSS - Add your custom CSS or Sass in /app/assets/sass/main.scss -->

<!-- Extends the NHS App layout from /app/views/layout-app.html -->
{% extends 'layout-app.html' %}

{% set hub = "Your health" %}
{% set pageHeading = "My BP - Hypertension Management" %}

<!-- For adding a breadcrumb or back link -->
{% block beforeContent %}
{% endblock %}

<!-- For adding page content -->
{% block content %}
  <div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-full">

      <!-- DYNAMIC PAGE TITLE -->
      {{ dynamicPageTitle({
        logo: data['web'] !== "yes",
        heading: "My BP",
        subtitle: "Hypertension Management Dashboard"
      })}}

      <!-- EMERGENCY SUPPORT BUTTON -->
      <div class="emergency-support nhsuk-u-margin-bottom-4">
        <div class="nhsuk-care-card nhsuk-care-card--urgent">
          <div class="nhsuk-care-card__heading-container">
            <h2 class="nhsuk-care-card__heading">
              <span role="img" aria-label="Emergency">üö®</span>
              Emergency support
            </h2>
          </div>
          <div class="nhsuk-care-card__content">
            <p>If you're experiencing severe symptoms, chest pain, difficulty breathing, or your BP is over 180/110 mmHg</p>
            <p><strong>Call 999 immediately</strong></p>
            <p class="nhsuk-u-margin-top-3 nhsuk-u-secondary-text-colour">For non-emergency concerns, contact your GP practice or call 111</p>
          </div>
        </div>
      </div>

      <!-- CURRENT STATUS OVERVIEW -->
      <div class="nhsuk-summary-card nhsuk-u-margin-bottom-5">
        <div class="nhsuk-summary-card__header">
          <h2 class="nhsuk-summary-card__title">Current status</h2>
          <p class="nhsuk-u-secondary-text-colour">Last updated today</p>
        </div>
        <div class="nhsuk-summary-card__body">
          <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-half">
              <h3 class="nhsuk-heading-m nhsuk-u-margin-bottom-2">Latest reading</h3>
              <p class="nhsuk-heading-l nhsuk-u-margin-bottom-1">138/82</p>
              <p class="nhsuk-u-secondary-text-colour">mmHg (3 days ago)</p>
            </div>
            <div class="nhsuk-grid-column-one-half">
              <strong class="nhsuk-tag nhsuk-tag--green nhsuk-u-margin-bottom-2">Normal</strong>
              <p class="nhsuk-u-secondary-text-colour">Target achieved</p>
            </div>
          </div>
        </div>
      </div>

      <!-- BP TRENDS CHART -->
      {{ nhsappSectionHeading({
        headingText: "Blood pressure trends"
      }) }}
      
      <div class="bp-trend-chart nhsuk-u-margin-bottom-5">
        <div class="bp-trend-chart__header">
          <p class="nhsuk-u-secondary-text-colour">Last 3 months</p>
        </div>
        
        <!-- Enhanced visual chart with better traffic light coding -->
        <div class="bp-chart">
          <div class="bp-chart__header">
            <h4 class="nhsuk-heading-s">Your BP progress</h4>
            <p class="nhsuk-u-secondary-text-colour nhsuk-u-margin-bottom-2">Trending downward - well done!</p>
          </div>
          
          <div class="bp-chart__visual">
            <!-- Simplified zone display -->
            <div class="bp-chart__zones">
              <div class="bp-chart__zone-info">
                <p class="nhsuk-u-secondary-text-colour nhsuk-u-margin-bottom-1">
                  <span class="bp-status-indicator bp-status-indicator--high"></span> High: 180+/110+
                  <span class="bp-status-indicator bp-status-indicator--elevated"></span> Elevated: 140-179/90-109
                  <span class="bp-status-indicator bp-status-indicator--normal"></span> Normal: Below 140/90
                </p>
              </div>
            </div>
            
            <!-- Data points -->
            <div class="bp-chart__points">
              <div class="bp-chart__point bp-chart__point--elevated" style="left: 10%;" data-reading="145/92" data-date="30 Sep">
                <span class="bp-chart__point-value">145/92</span>
              </div>
              <div class="bp-chart__point bp-chart__point--elevated" style="left: 35%;" data-reading="142/88" data-date="3 Oct">
                <span class="bp-chart__point-value">142/88</span>
              </div>
              <div class="bp-chart__point bp-chart__point--normal" style="left: 65%;" data-reading="139/85" data-date="7 Oct">
                <span class="bp-chart__point-value">139/85</span>
              </div>
              <div class="bp-chart__point bp-chart__point--normal" style="left: 90%;" data-reading="138/82" data-date="11 Oct">
                <span class="bp-chart__point-value">138/82</span>
              </div>
            </div>
            
            <!-- Trend line -->
            <div class="bp-chart__trend-line"></div>
          </div>
          
          <div class="bp-chart__legend">
            <div class="bp-chart__legend-item">
              <span class="bp-chart__legend-dot bp-chart__legend-dot--high"></span>
              <span>High (Action needed)</span>
            </div>
            <div class="bp-chart__legend-item">
              <span class="bp-chart__legend-dot bp-chart__legend-dot--elevated"></span>
              <span>Elevated (Monitor closely)</span>
            </div>
            <div class="bp-chart__legend-item">
              <span class="bp-chart__legend-dot bp-chart__legend-dot--normal"></span>
              <span>Normal (Target achieved)</span>
            </div>
          </div>
        </div>

        <!-- Traffic light coding table -->
        <div class="nhsuk-table-responsive nhsuk-u-margin-top-3">
          <table class="nhsuk-table">
            <thead class="nhsuk-table__head">
              <tr class="nhsuk-table__row">
                <th class="nhsuk-table__header" scope="col">Date</th>
                <th class="nhsuk-table__header" scope="col">Reading</th>
                <th class="nhsuk-table__header" scope="col">Status</th>
              </tr>
            </thead>
            <tbody class="nhsuk-table__body">
              <tr class="nhsuk-table__row">
                <td class="nhsuk-table__cell">11 Oct 2024</td>
                <td class="nhsuk-table__cell"><strong>138/82</strong></td>
                <td class="nhsuk-table__cell">
                  <strong class="nhsuk-tag nhsuk-tag--green">Normal</strong>
                </td>
              </tr>
              <tr class="nhsuk-table__row">
                <td class="nhsuk-table__cell">7 Oct 2024</td>
                <td class="nhsuk-table__cell">139/85</td>
                <td class="nhsuk-table__cell">
                  <strong class="nhsuk-tag nhsuk-tag--green">Normal</strong>
                </td>
              </tr>
              <tr class="nhsuk-table__row">
                <td class="nhsuk-table__cell">3 Oct 2024</td>
                <td class="nhsuk-table__cell">142/88</td>
                <td class="nhsuk-table__cell">
                  <strong class="nhsuk-tag nhsuk-tag--orange">Elevated</strong>
                </td>
              </tr>
              <tr class="nhsuk-table__row">
                <td class="nhsuk-table__cell">30 Sep 2024</td>
                <td class="nhsuk-table__cell">145/92</td>
                <td class="nhsuk-table__cell">
                  <strong class="nhsuk-tag nhsuk-tag--orange">Elevated</strong>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- NEXT ACTIONS -->
      {{ nhsappSectionHeading({
        headingText: "Your next actions"
      }) }}
      
      <div class="nhsuk-care-card nhsuk-care-card--non-urgent nhsuk-u-margin-bottom-4">
        <div class="nhsuk-care-card__heading-container">
          <h3 class="nhsuk-care-card__heading">
            <span role="img" aria-label="Information">‚ÑπÔ∏è</span>
            Book U&E blood test
          </h3>
        </div>
        <div class="nhsuk-care-card__content">
          <p>Your safety monitoring blood test is due. Please book within the next 7 days.</p>
          <div class="nhsuk-action-link">
            <a class="nhsuk-action-link__link" href="/pages/mybp/blood-test/index">
              <svg class="nhsuk-icon nhsuk-icon__arrow-right-circle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" width="36" height="36">
                <path d="m0 0h24v24h-24z" fill="none"/>
                <path d="m12 2a10 10 0 1 0 10 10 10.011 10.011 0 0 0 -10-10zm5.293 11.293-3.293 3.293v-8.586l3.293 3.293a1 1 0 0 1 0 1.414z"/>
              </svg>
              <span class="nhsuk-action-link__text">Book now</span>
            </a>
          </div>
        </div>
      </div>

      <div class="nhsuk-care-card nhsuk-care-card--non-urgent nhsuk-u-margin-bottom-4">
        <div class="nhsuk-care-card__heading-container">
          <h3 class="nhsuk-care-card__heading">
            <span role="img" aria-label="Information">üìä</span>
            Next BP measurement
          </h3>
        </div>
        <div class="nhsuk-care-card__content">
          <p>We will send you a notification on Thursday to remind you to measure your blood pressure.</p>
          <p class="nhsuk-u-secondary-text-colour nhsuk-u-margin-top-2">You don't need to do anything today for this.</p>
        </div>
      </div>

      <!-- MEDICATION REMINDERS -->
      {{ nhsappSectionHeading({
        headingText: "Medication reminders"
      }) }}
      
      <div class="medication-summary nhsuk-u-margin-bottom-5">
        <div class="nhsuk-summary-card">
          <div class="nhsuk-summary-card__header">
            <h3 class="nhsuk-summary-card__title">Adherence this week</h3>
          </div>
          <div class="nhsuk-summary-card__body">
            <div class="medication-adherence">
              <div class="medication-adherence__score">
                <span class="medication-adherence__percentage">86%</span>
                <span class="medication-adherence__label">taken on time</span>
              </div>
              <div class="medication-adherence__progress">
                <div class="medication-adherence__progress-bar" style="width: 86%"></div>
              </div>
            </div>
            <p class="nhsuk-u-margin-top-3"><strong>Current medication:</strong> Amlodipine 5mg daily</p>
            <p class="nhsuk-u-secondary-text-colour">Next dose due: Today at 8:00 PM</p>
          </div>
        </div>
      </div>

      <!-- LIFESTYLE PROGRESS -->
      {{ nhsappSectionHeading({
        headingText: "Lifestyle progress"
      }) }}
      
      <div class="lifestyle-progress nhsuk-u-margin-bottom-5">
        <div class="nhsuk-grid-row">
          <div class="nhsuk-grid-column-one-half">
            <div class="nhsuk-summary-card">
              <div class="nhsuk-summary-card__header">
                <h4 class="nhsuk-summary-card__title">Weekly exercise</h4>
              </div>
              <div class="nhsuk-summary-card__body">
                <div class="progress-indicator">
                  <div class="progress-indicator__circle progress-indicator__circle--good">
                    <span class="progress-indicator__value">3/5</span>
                  </div>
                  <p class="nhsuk-u-margin-top-2">Days active</p>
                </div>
              </div>
            </div>
          </div>
          <div class="nhsuk-grid-column-one-half">
            <div class="nhsuk-summary-card">
              <div class="nhsuk-summary-card__header">
                <h4 class="nhsuk-summary-card__title">Healthy eating</h4>
              </div>
              <div class="nhsuk-summary-card__body">
                <div class="progress-indicator">
                  <div class="progress-indicator__circle progress-indicator__circle--excellent">
                    <span class="progress-indicator__value">4/5</span>
                  </div>
                  <p class="nhsuk-u-margin-top-2">Days on track</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
{% endblock %}
