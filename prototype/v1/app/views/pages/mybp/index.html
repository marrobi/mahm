<!-- Patient Dashboard UI for My BP - NHS App -->

<!-- ADDING CUSTOM CSS - Add your custom CSS or Sass in /app/assets/sass/main.scss -->

<!-- Extends the NHS App layout from /app/views/layout-app.html -->
{% extends 'layout-app.html' %}

{% set hub = "Your health" %}
{% set pageHeading = "My BP - Hypertension Management" %}

<!-- For adding a breadcrumb or back link -->
{% block beforeContent %}
{% endblock %}

<!-- For adding page content -->
{% block content %}
  <div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-full">

      <!-- DYNAMIC PAGE TITLE -->
      {{ dynamicPageTitle({
        logo: data['web'] !== "yes",
        heading: "My BP",
        subtitle: "Hypertension Management Dashboard"
      })}}

      <!-- CURRENT STATUS OVERVIEW -->
      <div class="nhsuk-summary-card nhsuk-u-margin-bottom-5">
        <div class="nhsuk-summary-card__header">
          <h2 class="nhsuk-summary-card__title">Current status</h2>
          <p class="nhsuk-u-secondary-text-colour">Last updated today</p>
        </div>
        <div class="nhsuk-summary-card__body">
          <div class="nhsuk-grid-row">
            <div class="nhsuk-grid-column-one-half">
              <h3 class="nhsuk-heading-m nhsuk-u-margin-bottom-2">Latest reading</h3>
              <p class="nhsuk-heading-l nhsuk-u-margin-bottom-1">138/82</p>
              <p class="nhsuk-u-secondary-text-colour">mmHg (3 days ago)</p>
            </div>
            <div class="nhsuk-grid-column-one-half">
              <strong class="nhsuk-tag nhsuk-tag--green nhsuk-u-margin-bottom-2">Normal</strong>
              <p class="nhsuk-u-secondary-text-colour">Target achieved</p>
            </div>
          </div>
        </div>
      </div>

      <!-- BP TRENDS CHART -->
      {{ nhsappSectionHeading({
        headingText: "Blood pressure trends"
      }) }}
      
      <div class="bp-trend-chart nhsuk-u-margin-bottom-5">
        <div class="bp-trend-chart__header">
          <p class="nhsuk-u-secondary-text-colour">Last 3 months</p>
        </div>
        
        <!-- Simple visual chart using CSS -->
        <div class="bp-chart">
          <div class="bp-chart__grid">
            <div class="bp-chart__line bp-chart__line--systolic" data-values="145,142,139,138"></div>
            <div class="bp-chart__line bp-chart__line--diastolic" data-values="92,88,85,82"></div>
          </div>
          <div class="bp-chart__legend">
            <div class="bp-chart__legend-item">
              <span class="bp-chart__legend-color bp-chart__legend-color--systolic"></span>
              <span>Systolic (target &lt;140)</span>
            </div>
            <div class="bp-chart__legend-item">
              <span class="bp-chart__legend-color bp-chart__legend-color--diastolic"></span>
              <span>Diastolic (target &lt;90)</span>
            </div>
          </div>
        </div>

        <!-- Traffic light coding table -->
        <div class="nhsuk-table-responsive nhsuk-u-margin-top-3">
          <table class="nhsuk-table">
            <thead class="nhsuk-table__head">
              <tr class="nhsuk-table__row">
                <th class="nhsuk-table__header" scope="col">Date</th>
                <th class="nhsuk-table__header" scope="col">Reading</th>
                <th class="nhsuk-table__header" scope="col">Status</th>
              </tr>
            </thead>
            <tbody class="nhsuk-table__body">
              <tr class="nhsuk-table__row">
                <td class="nhsuk-table__cell">11 Oct 2024</td>
                <td class="nhsuk-table__cell"><strong>138/82</strong></td>
                <td class="nhsuk-table__cell">
                  <strong class="nhsuk-tag nhsuk-tag--green">Normal</strong>
                </td>
              </tr>
              <tr class="nhsuk-table__row">
                <td class="nhsuk-table__cell">7 Oct 2024</td>
                <td class="nhsuk-table__cell">139/85</td>
                <td class="nhsuk-table__cell">
                  <strong class="nhsuk-tag nhsuk-tag--green">Normal</strong>
                </td>
              </tr>
              <tr class="nhsuk-table__row">
                <td class="nhsuk-table__cell">3 Oct 2024</td>
                <td class="nhsuk-table__cell">142/88</td>
                <td class="nhsuk-table__cell">
                  <strong class="nhsuk-tag nhsuk-tag--orange">Elevated</strong>
                </td>
              </tr>
              <tr class="nhsuk-table__row">
                <td class="nhsuk-table__cell">30 Sep 2024</td>
                <td class="nhsuk-table__cell">145/92</td>
                <td class="nhsuk-table__cell">
                  <strong class="nhsuk-tag nhsuk-tag--red">High</strong>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- NEXT ACTIONS -->
      {{ nhsappSectionHeading({
        headingText: "Your next actions"
      }) }}
      
      <div class="nhsuk-care-card nhsuk-care-card--immediate nhsuk-u-margin-bottom-4">
        <div class="nhsuk-care-card__heading-container">
          <h3 class="nhsuk-care-card__heading">
            <span role="img" aria-label="Urgent">ðŸ”´</span>
            Book U&E blood test
          </h3>
        </div>
        <div class="nhsuk-care-card__content">
          <p>Your safety monitoring blood test is due. Please book within the next 7 days.</p>
          <div class="nhsuk-action-link">
            <a class="nhsuk-action-link__link" href="/pages/mybp/blood-test/index">
              <svg class="nhsuk-icon nhsuk-icon__arrow-right-circle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" width="36" height="36">
                <path d="m0 0h24v24h-24z" fill="none"/>
                <path d="m12 2a10 10 0 1 0 10 10 10.011 10.011 0 0 0 -10-10zm5.293 11.293-3.293 3.293v-8.586l3.293 3.293a1 1 0 0 1 0 1.414z"/>
              </svg>
              <span class="nhsuk-action-link__text">Book now</span>
            </a>
          </div>
        </div>
      </div>

      <div class="nhsuk-care-card nhsuk-care-card--non-urgent nhsuk-u-margin-bottom-4">
        <div class="nhsuk-care-card__heading-container">
          <h3 class="nhsuk-care-card__heading">
            <span role="img" aria-label="Information">ðŸŸ¡</span>
            Next BP measurement
          </h3>
        </div>
        <div class="nhsuk-care-card__content">
          <p>Your next measurement is recommended in 2-3 weeks to continue monitoring your progress.</p>
          <div class="nhsuk-action-link">
            <a class="nhsuk-action-link__link" href="/pages/mybp/bp-measurement/index">
              <svg class="nhsuk-icon nhsuk-icon__arrow-right-circle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" width="36" height="36">
                <path d="m0 0h24v24h-24z" fill="none"/>
                <path d="m12 2a10 10 0 1 0 10 10 10.011 10.011 0 0 0 -10-10zm5.293 11.293-3.293 3.293v-8.586l3.293 3.293a1 1 0 0 1 0 1.414z"/>
              </svg>
              <span class="nhsuk-action-link__text">Schedule measurement</span>
            </a>
          </div>
        </div>
      </div>

      <!-- MEDICATION REMINDERS -->
      {{ nhsappSectionHeading({
        headingText: "Medication reminders"
      }) }}
      
      <div class="medication-summary nhsuk-u-margin-bottom-5">
        <div class="nhsuk-summary-card">
          <div class="nhsuk-summary-card__header">
            <h3 class="nhsuk-summary-card__title">Adherence this week</h3>
          </div>
          <div class="nhsuk-summary-card__body">
            <div class="medication-adherence">
              <div class="medication-adherence__score">
                <span class="medication-adherence__percentage">86%</span>
                <span class="medication-adherence__label">taken on time</span>
              </div>
              <div class="medication-adherence__progress">
                <div class="medication-adherence__progress-bar" style="width: 86%"></div>
              </div>
            </div>
            <p class="nhsuk-u-margin-top-3"><strong>Current medication:</strong> Amlodipine 5mg daily</p>
            <p class="nhsuk-u-secondary-text-colour">Next dose due: Today at 8:00 PM</p>
          </div>
        </div>
      </div>

      <!-- LIFESTYLE PROGRESS -->
      {{ nhsappSectionHeading({
        headingText: "Lifestyle progress"
      }) }}
      
      <div class="lifestyle-progress nhsuk-u-margin-bottom-5">
        <div class="nhsuk-grid-row">
          <div class="nhsuk-grid-column-one-half">
            <div class="nhsuk-summary-card">
              <div class="nhsuk-summary-card__header">
                <h4 class="nhsuk-summary-card__title">Weekly exercise</h4>
              </div>
              <div class="nhsuk-summary-card__body">
                <div class="progress-indicator">
                  <div class="progress-indicator__circle">
                    <span class="progress-indicator__value">3/5</span>
                  </div>
                  <p class="nhsuk-u-margin-top-2">Days active</p>
                </div>
              </div>
            </div>
          </div>
          <div class="nhsuk-grid-column-one-half">
            <div class="nhsuk-summary-card">
              <div class="nhsuk-summary-card__header">
                <h4 class="nhsuk-summary-card__title">Healthy eating</h4>
              </div>
              <div class="nhsuk-summary-card__body">
                <div class="progress-indicator">
                  <div class="progress-indicator__circle progress-indicator__circle--good">
                    <span class="progress-indicator__value">4/5</span>
                  </div>
                  <p class="nhsuk-u-margin-top-2">Days on track</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- QUICK ACTIONS -->
      {{ nhsappSectionHeading({
        headingText: "Quick actions"
      }) }}
      
      <div class="quick-actions">
        {{ nhsappCardGroup({
          cards: [
            {
              title: "Record BP reading",
              href: "/pages/mybp/bp-measurement/record",
              description: "Manually log a home reading"
            },
            {
              title: "Medication review",
              href: "/pages/mybp/dose-titration/index",
              description: "Check if dose needs adjusting"
            },
            {
              title: "Book appointment",
              href: "/pages/services/gp-appointment-select",
              description: "See your GP or nurse"
            }
          ]
        }) }}
      </div>

    </div>
  </div>
{% endblock %}
